backdrops:
  make:
    image:
      steps: |
        FROM golang:1.12-alpine
        RUN apk add -U git bash curl tree make protobuf
        RUN go get -u github.com/mitchellh/gox
        RUN go get -u github.com/golang/protobuf/protoc-gen-go
        RUN go get -u github.com/golangci/golangci-lint/cmd/golangci-lint
    environment: CGO_ENABLED=0
    volumes:
      - "{{ projectRoot }}:/build"
      - "{{ projectRoot }}/.cache:/go/pkg/mod"
      - "{{ user.HomeDir }}/.dodo:/root/.dodo"
    working_dir: /build
    script: make $@
    command: all
